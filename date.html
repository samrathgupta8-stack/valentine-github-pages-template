<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Online Date ğŸ’Œ</title>
    <link rel="stylesheet" href="css/theme.css" />
    <script src="config.js"></script>
  </head>

  <body>
    <main class="wrap">
      <section class="card" style="padding:18px 16px 18px;">
        <div class="title">Okay <span class="pink" id="nick">Babe</span>â€¦ pick our online date ğŸ’˜</div>
        <p class="subtitle">Pick one vibe. Then (optional) choose the day.</p>

        <div class="grid" id="choices"></div>

        <div style="margin-top:14px;">
          <span class="pill" id="pickedPill" style="font-size:15px;">Chosen: tap an option âœ¨</span>
        </div>

        <div style="margin-top:14px; text-align:left;">
          <div style="font-size:12px; color:rgba(47,34,34,.62); margin:0 0 6px 6px;">Day (optional)</div>
          <input id="day" type="date" style="width:100%; padding:14px 12px; border-radius:18px; border:1px solid rgba(255,95,158,.22); background:rgba(255,255,255,.78); font-size:16px;" />
        </div>

        <div style="margin-top:14px;">
          <button class="btn btnPrimary btnFull" id="continueBtn" disabled>Continue ğŸ’Œ</button>
          <div class="tip" style="margin-top:10px;">No day chosen = â€œwhenever youâ€™re freeâ€ ğŸ˜„</div>
        </div>
      </section>
    </main>

    <script>
      const cfg = window.VALENTINE_CONFIG || {};
      document.getElementById('nick').textContent = cfg.nickname || 'Babe';

      const cardsWrap = document.getElementById('choices');
      const options = Array.isArray(cfg.dateOptions) && cfg.dateOptions.length ? cfg.dateOptions : [];

      cardsWrap.innerHTML = options.map((o, idx) => `
        <div class="option" data-choice="${o.title} ${o.emoji}" data-note="${(o.note||'').replace(/"/g,'&quot;')}">
          <div class="optionTitle">${o.title} ${o.emoji}</div>
          <p class="optionText">${o.subtitle || ''}</p>
        </div>
      `).join('');

      const cards = document.querySelectorAll('.option');
      const pickedPill = document.getElementById('pickedPill');
      const continueBtn = document.getElementById('continueBtn');
      const day = document.getElementById('day');

      let choice = '';
      let note = '';

      // Min date: today
      const t = new Date();
      const yyyy = t.getFullYear();
      const mm = String(t.getMonth()+1).padStart(2,'0');
      const dd = String(t.getDate()).padStart(2,'0');
      day.min = `${yyyy}-${mm}-${dd}`;

      cards.forEach(c => {
        c.addEventListener('click', () => {
          cards.forEach(x => x.classList.remove('active'));
          c.classList.add('active');
          choice = c.dataset.choice;
          note = c.dataset.note || '';
          pickedPill.textContent = 'Chosen: ' + choice;
          continueBtn.disabled = false;
        });
      });

      continueBtn.addEventListener('click', () => {
        const whenDay = day.value ? day.value : 'Any day';
        localStorage.setItem('online_choice', choice);
        localStorage.setItem('online_note', note);
        localStorage.setItem('online_when', whenDay);
        location.href = 'food.html';
      });
    </script>
  </body>
</html>
